!function e(t,r,n){function o(c,i){if(!r[c]){if(!t[c]){var s="function"==typeof require&&require;if(!i&&s)return s(c,!0);if(a)return a(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[c]={exports:{}};t[c][0].call(d.exports,function(e){var r=t[c][1][e];return o(r?r:e)},d,d.exports,e,t,r,n)}return r[c].exports}for(var a="function"==typeof require&&require,c=0;c<n.length;c++)o(n[c]);return o}({1:[function(e,t,r){var n=React.createClass({displayName:"NextWordBtn",render:function(){return React.createElement("div",{className:"next"},React.createElement("button",{type:"button",className:"btn btn-full",onClick:this.props.onClick},"Next Word"))}}),o=React.createClass({displayName:"PercentCorrect",render:function(){return React.createElement("div",null,React.createElement("h2",null,"Score:"),React.createElement("h2",{className:"score"},this.props.percentCorrect,"%"))}}),a=React.createClass({displayName:"PlayWordBtn",render:function(){return React.createElement("div",{className:"usr-options"},React.createElement("button",{type:"button",className:"sound",onClick:this.props.playWord},React.createElement("i",{className:"icon ion-volume-high"})))}}),c=React.createClass({displayName:"RecordAudioBtn",render:function(){return React.createElement("div",{className:"usr-options"},React.createElement("button",{type:"button",className:"microphone",onMouseDown:this.props.startRecording,onMouseUp:this.props.stopRecording},React.createElement("i",{className:"icon ion-mic-a"})))}}),i=React.createClass({displayName:"TargetWord",render:function(){return React.createElement("div",null,React.createElement("h2",{className:"target-word"},this.props.targetWord))}}),s=React.createClass({displayName:"PronunciationTest",recordRTC:null,loadWordFromServer:function(){var e=this.compileNextWordUrl();$.ajax({url:e,dataType:"json",success:function(e){this.setState({targetWord:e.word,s3key:e.s3.Key})}.bind(this)})},compileNextWordUrl:function(){var e="language="+this.state.language,t="gender="+this.state.gender,r="/api/words/index/?"+e+"&"+t;return r},playWord:function(){function e(){var e=new XMLHttpRequest;e.open("GET","https://localhost:3000/api/audio/"+n,!0),e.responseType="arraybuffer",e.onload=function(){var r=e.response;t(r)},e.send()}function t(e){var t=r.createBufferSource();r.decodeAudioData(e,function(e){t.buffer=e,t.connect(r.destination),t.start(r.currentTime),t.onended=function(){r.close()}})}window.AudioContext=window.AudioContext||window.webkitAudioContext;var r=new AudioContext,n=this.state.s3key;e()},requestUserAudioPermission:function(){var e={audio:!0,video:!1},t=function(e){var t={type:"audio",numberOfAudioChannels:1};this.recordRTC=RecordRTC(e,t)},r=function(e){console.log(e)};navigator.getUserMedia(e,t.bind(this),r)},startRecordingUserAudio:function(){this.recordRTC.startRecording()},stopRecordingUserAudio:function(){this.recordRTC.stopRecording(function(e){var t=this.recordRTC.blob;this.postAudioFile(t)}.bind(this))},postAudioFile:function(e){var t=new FormData;t.append("userAudio",e),$.ajax({type:"POST",url:"/api/audio/",data:t,processData:!1,contentType:"audio/wav",success:function(e){this.recordRTC.clearRecordedData();var t=Math.floor(e);this.setState({percentCorrect:t})}.bind(this),error:function(e,t,r){console.error("/api/audio",t,r.toString())}.bind(this)})},postTargetWord:function(){$.ajax({type:"POST",url:"/api/word/",data:{word:this.state.targetWord},success:function(e){alert(e)}.bind(this),error:function(e,t,r){console.error("/api/word/",t,r.toString())}.bind(this)})},getInitialState:function(){return{language:"english",gender:"male",targetWord:null,percentCorrect:null}},componentDidMount:function(){this.loadWordFromServer(),this.requestUserAudioPermission()},render:function(){return React.createElement("div",null,React.createElement(i,{targetWord:this.state.targetWord}),React.createElement(a,{playWord:this.playWord}),React.createElement(c,{startRecording:this.startRecordingUserAudio,stopRecording:this.stopRecordingUserAudio}),React.createElement(o,{percentCorrect:this.state.percentCorrect}),React.createElement(n,{onClick:this.loadWordFromServer}))}}),l=React.createClass({displayName:"Instructions",render:function(){return React.createElement("div",null,React.createElement("h3",null,"Click and hold the microphone button, while pronouncing the word shown below"))}}),d=React.createClass({displayName:"Title",render:function(){return React.createElement("div",null,React.createElement("h1",{className:"title"},"Vocalize"))}}),u=React.createClass({displayName:"VocalizeApp",render:function(){return React.createElement("div",null,React.createElement(d,null),React.createElement(l,null),React.createElement(s,null))}});ReactDOM.render(React.createElement(u,null),document.getElementById("vocalizeApp"))},{}]},{},[1]);