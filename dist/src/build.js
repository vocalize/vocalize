(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/andrew/Documents/Hack Reactor/vocalize/public/main.js":[function(require,module,exports){
 /*
React Component Hierarchy
  -VocalizeApp
    -Title
    -Instructions
    -PronunciationTest
      -TargetWord
      -PlayWordBtn
      -RecordAudioBtn
      -PercentCorrect
      -NextWordBtn
*/

var NextWordBtn = React.createClass({displayName: "NextWordBtn",

  render: function(){
    return (
      React.createElement("div", {className: "next"}, 
        React.createElement("button", {
          type: "button", 
          className: "btn btn-full", 
          onClick: this.props.onClick
        }, 
          "Next Word"
        )
      )
    );
  }
});

var PercentCorrect = React.createClass({displayName: "PercentCorrect",
  render: function(){
    return (
      React.createElement("div", null, 
        React.createElement("h2", null, "Score:"), 
        React.createElement("h2", {className: "score"}, 
          this.props.percentCorrect, "%"
        )
      )
    );
  }
});

var PlayWordBtn = React.createClass({displayName: "PlayWordBtn",

  render: function() {
    return ( 
      React.createElement("div", {className: "usr-options"}, 
        React.createElement("button", {type: "button", 
          className: "sound", 
          onClick: this.props.playWord
        }, 
          React.createElement("i", {className: "icon ion-volume-high"})
        )
      )
    );
  }
});

var RecordAudioBtn = React.createClass({displayName: "RecordAudioBtn",
  render: function() {
    return (
      React.createElement("div", {className: "usr-options"}, 
        React.createElement("button", {
          type: "button", 
          className: "microphone", 
          onMouseDown: this.props.startRecording, 
          onMouseUp: this.props.stopRecording
        }, 
          React.createElement("i", {className: "icon ion-mic-a"})
        )
      )    
    );
  }
});

var TargetWord = React.createClass({displayName: "TargetWord",
  render: function(){
    return (
      React.createElement("div", null, 
        React.createElement("h2", {className: "target-word"}, 
          this.props.targetWord
        )
      )
    );
  }
});
 
var PronunciationTest = React.createClass({displayName: "PronunciationTest",
  recordRTC: null,

  loadWordFromServer: function() {
    var url = this.compileNextWordUrl();

    $.ajax({
      url: url,
      dataType: 'json',
      success: function(data) {
        this.setState({targetWord: data.word, s3key: data.s3.Key});
      }.bind(this)
    });
  },

  compileNextWordUrl : function() {
    /*
      Example: /api/words/index/?language=english&gender=male
    */
    var language = 'language=' + this.state.language;
    var gender = 'gender=' + this.state.gender;
    var url = '/api/words/index/?' + language + '&' + gender;
    
    return url;
  },

  playWord: function() {
    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    var context = new AudioContext();
    var s3key = this.state.s3key;

    function loadSound() {
      var request = new XMLHttpRequest();
      request.open("GET", "https://localhost:3000/api/audio/" + s3key, true);
      request.responseType = "arraybuffer";

      request.onload = function() {
        var Data = request.response;
        process(Data);
      };

      request.send();
    }

    function process(Data) {
      var source = context.createBufferSource(); // Create Sound Source
      context.decodeAudioData(Data, function(buffer) {
        source.buffer = buffer;
        source.connect(context.destination);
        source.start(context.currentTime);
        // Close audio context when file is done
        source.onended = function(){
          context.close();
        }
      });
    }

    loadSound();
  },

  requestUserAudioPermission: function() {
    var mediaConstraints = {
      audio: true,
      video: false
    };

    var successCallback = function (mediaStream) {
      var config = {
        type: 'audio',
        numberOfAudioChannels: 1
      };

      this.recordRTC = RecordRTC(mediaStream, config);
    };

    var errorCallback = function(err) {
      console.log(err);
    };

    // TODO: check for browser compatability with navigator.mediaDevices.getUserMedia()
    // navigator.getUserMedia is deprecated and should be avoided if possible
    navigator.getUserMedia(mediaConstraints, successCallback.bind(this), errorCallback);
  },

  startRecordingUserAudio: function() {
    this.recordRTC.startRecording();
  },

  stopRecordingUserAudio: function() {
    this.recordRTC.stopRecording(function(audioURL) {
      var soundBlob = this.recordRTC.blob;
      this.postAudioFile(soundBlob);
    }.bind(this));
  },
  postAudioFile: function(soundBlob) {
    var formData = new FormData();
    formData.append('userAudio', soundBlob);
    $.ajax({
      type: 'POST',
      url: '/api/audio/',
      data: formData,
      processData: false,
      contentType: 'audio/wav',
      success: function(data) {
        this.recordRTC.clearRecordedData();
        var percentCorrect = Math.floor(data);
        this.setState({
          percentCorrect: percentCorrect
        });
      }.bind(this),
      error: function(xhr, status, err) {
        console.error('/api/audio', status, err.toString());
      }.bind(this)
    });
  },

  postTargetWord: function() {
    $.ajax({
      type: 'POST',
      url: '/api/word/',
      data: {'word': this.state.targetWord},
      success: function(data) {
        alert(data);
      }.bind(this),
      error: function(xhr, status, err) {
        console.error('/api/word/', status, err.toString());
      }.bind(this)
    });  
  },

  getInitialState: function() {
    return {
      language: 'english',
      gender: 'male',
      targetWord: null,
      percentCorrect: null,
    };
  },

  componentDidMount: function() {
    this.loadWordFromServer();
    this.requestUserAudioPermission();
  },

  render: function(){
    return (
      React.createElement("div", null, 
        React.createElement(TargetWord, {targetWord: this.state.targetWord}), 
        React.createElement(PlayWordBtn, {playWord: this.playWord}), 
        React.createElement(RecordAudioBtn, {
          startRecording: this.startRecordingUserAudio, 
          stopRecording: this.stopRecordingUserAudio}
        ), 
        React.createElement(PercentCorrect, {percentCorrect: this.state.percentCorrect}), 
        React.createElement(NextWordBtn, {onClick: this.loadWordFromServer})
      )
    );
    }
  });

var Instructions = React.createClass({displayName: "Instructions",
  render: function(){
    return (
      React.createElement("div", null, 
        React.createElement("h3", null, 
          "Click and hold the microphone button, while pronouncing the word shown below"
        )
      )
    );
  }
});

var Title = React.createClass({displayName: "Title",
  render: function(){
    return (
      React.createElement("div", null, 
        React.createElement("h1", {className: "title"}, "Vocalize")
      )
    );
  }
});

var VocalizeApp = React.createClass({displayName: "VocalizeApp",
  render: function(){
    return (
      React.createElement("div", null, 
        React.createElement(Title, null), 
        React.createElement(Instructions, null), 
        React.createElement(PronunciationTest, null)
      )
    );
  }
});

ReactDOM.render(
  React.createElement(VocalizeApp, null), 
  document.getElementById('vocalizeApp')
);

},{}]},{},["/Users/andrew/Documents/Hack Reactor/vocalize/public/main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvYW5kcmV3L0RvY3VtZW50cy9IYWNrIFJlYWN0b3Ivdm9jYWxpemUvcHVibGljL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLEVBQUU7O0FBRUYsSUFBSSxpQ0FBaUMsMkJBQUE7O0VBRW5DLE1BQU0sRUFBRSxVQUFVO0lBQ2hCO01BQ0Usb0JBQUEsS0FBSSxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxNQUFPLENBQUEsRUFBQTtRQUNwQixvQkFBQSxRQUFPLEVBQUEsQ0FBQTtVQUNMLElBQUEsRUFBSSxDQUFDLFFBQUEsRUFBUTtVQUNiLFNBQUEsRUFBUyxDQUFDLGNBQUEsRUFBYztVQUN4QixPQUFBLEVBQU8sQ0FBRSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQVE7UUFDN0IsQ0FBQSxFQUFBO0FBQUEsVUFBQSxXQUFBO0FBQUEsUUFFUSxDQUFBO01BQ0wsQ0FBQTtNQUNOO0dBQ0g7QUFDSCxDQUFDLENBQUMsQ0FBQzs7QUFFSCxJQUFJLG9DQUFvQyw4QkFBQTtFQUN0QyxNQUFNLEVBQUUsVUFBVTtJQUNoQjtNQUNFLG9CQUFBLEtBQUksRUFBQSxJQUFDLEVBQUE7UUFDSCxvQkFBQSxJQUFHLEVBQUEsSUFBQyxFQUFBLFFBQVcsQ0FBQSxFQUFBO1FBQ2Ysb0JBQUEsSUFBRyxFQUFBLENBQUEsQ0FBQyxTQUFBLEVBQVMsQ0FBQyxPQUFRLENBQUEsRUFBQTtVQUNuQixJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBQyxHQUFBO0FBQUEsUUFDeEIsQ0FBQTtNQUNELENBQUE7TUFDTjtHQUNIO0FBQ0gsQ0FBQyxDQUFDLENBQUM7O0FBRUgsSUFBSSxpQ0FBaUMsMkJBQUE7O0VBRW5DLE1BQU0s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SDtBQUNILENBQUMsQ0FBQyxDQUFDOztBQUVILElBQUksMkJBQTJCLHFCQUFBO0VBQzdCLE1BQU0sRUFBRSxVQUFVO0lBQ2hCO01BQ0Usb0JBQUEsS0FBSSxFQUFBLElBQUMsRUFBQTtRQUNILG9CQUFBLElBQUcsRUFBQSxDQUFBLENBQUMsU0FBQSxFQUFTLENBQUMsT0FBUSxDQUFBLEVBQUEsVUFBYSxDQUFBO01BQy9CLENBQUE7TUFDTjtHQUNIO0FBQ0gsQ0FBQyxDQUFDLENBQUM7O0FBRUgsSUFBSSxpQ0FBaUMsMkJBQUE7RUFDbkMsTUFBTSxFQUFFLFVBQVU7SUFDaEI7TUFDRSxvQkFBQSxLQUFJLEVBQUEsSUFBQyxFQUFBO1FBQ0gsb0JBQUMsS0FBSyxFQUFBLElBQUEsQ0FBRyxDQUFBLEVBQUE7UUFDVCxvQkFBQyxZQUFZLEVBQUEsSUFBQSxDQUFHLENBQUEsRUFBQTtRQUNoQixvQkFBQyxpQkFBaUIsRUFBQSxJQUFBLENBQUcsQ0FBQTtNQUNqQixDQUFBO01BQ047R0FDSDtBQUNILENBQUMsQ0FBQyxDQUFDOztBQUVILFFBQVEsQ0FBQyxNQUFNO0VBQ2Isb0JBQUMsV0FBVyxFQUFBLElBQUUsQ0FBQTtFQUNkLFFBQVEsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDO0NBQ3ZDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIiAvKlxuUmVhY3QgQ29tcG9uZW50IEhpZXJhcmNoeVxuICAtVm9jYWxpemVBcHBcbiAgICAtVGl0bGVcbiAgICAtSW5zdHJ1Y3Rpb25zXG4gICAgLVByb251bmNpYXRpb25UZXN0XG4gICAgICAtVGFyZ2V0V29yZFxuICAgICAgLVBsYXlXb3JkQnRuXG4gICAgICAtUmVjb3JkQXVkaW9CdG5cbiAgICAgIC1QZXJjZW50Q29ycmVjdFxuICAgICAgLU5leHRXb3JkQnRuXG4qL1xuXG52YXIgTmV4dFdvcmRCdG4gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cbiAgcmVuZGVyOiBmdW5jdGlvbigpe1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm5leHRcIj5cbiAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICB0eXBlPSdidXR0b24nXG4gICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1mdWxsXCIgXG4gICAgICAgICAgb25DbGljaz17dGhpcy5wcm9wcy5vbkNsaWNrfVxuICAgICAgICA+XG4gICAgICAgICAgTmV4dCBXb3JkXG4gICAgICAgIDwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBQZXJjZW50Q29ycmVjdCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVuZGVyOiBmdW5jdGlvbigpe1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2PlxuICAgICAgICA8aDI+U2NvcmU6PC9oMj5cbiAgICAgICAgPGgyIGNsYXNzTmFtZT1cInNjb3JlXCI+XG4gICAgICAgICAge3RoaXMucHJvcHMucGVyY2VudENvcnJlY3R9JVxuICAgICAgICA8L2gyPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBQbGF5V29yZEJ0biA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoIFxuICAgICAgPCBkaXYgY2xhc3NOYW1lID0gXCJ1c3Itb3B0aW9uc1wiID5cbiAgICAgICAgPGJ1dHRvbiB0eXBlID0gXCJidXR0b25cIlxuICAgICAgICAgIGNsYXNzTmFtZSA9IFwic291bmRcIlxuICAgICAgICAgIG9uQ2xpY2sgPSB7dGhpcy5wcm9wcy5wbGF5V29yZH0gXG4gICAgICAgID5cbiAgICAgICAgICA8aSBjbGFzc05hbWU9XCJpY29uIGlvbi12b2x1bWUtaGlnaFwiPjwvaT5cbiAgICAgICAgPC9idXR0b24+IFxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBSZWNvcmRBdWRpb0J0biA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1c3Itb3B0aW9uc1wiPlxuICAgICAgICA8YnV0dG9uIFxuICAgICAgICAgIHR5cGU9XCJidXR0b25cIiBcbiAgICAgICAgICBjbGFzc05hbWU9XCJtaWNyb3Bob25lXCIgXG4gICAgICAgICAgb25Nb3VzZURvd249e3RoaXMucHJvcHMuc3RhcnRSZWNvcmRpbmd9XG4gICAgICAgICAgb25Nb3VzZVVwPXt0aGlzLnByb3BzLnN0b3BSZWNvcmRpbmd9XG4gICAgICAgID5cbiAgICAgICAgICA8aSBjbGFzc05hbWU9XCJpY29uIGlvbi1taWMtYVwiPjwvaT5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj4gICAgXG4gICAgKTtcbiAgfVxufSk7XG5cbnZhciBUYXJnZXRXb3JkID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICByZW5kZXI6IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0YXJnZXQtd29yZFwiPlxuICAgICAgICAgIHt0aGlzLnByb3BzLnRhcmdldFdvcmR9XG4gICAgICAgIDwvaDI+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59KTtcbiBcbnZhciBQcm9udW5jaWF0aW9uVGVzdCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVjb3JkUlRDOiBudWxsLFxuXG4gIGxvYWRXb3JkRnJvbVNlcnZlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVybCA9IHRoaXMuY29tcGlsZU5leHRXb3JkVXJsKCk7XG5cbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiB1cmwsXG4gICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHt0YXJnZXRXb3JkOiBkYXRhLndvcmQsIHMza2V5OiBkYXRhLnMzLktleX0pO1xuICAgICAgfS5iaW5kKHRoaXMpXG4gICAgfSk7XG4gIH0sXG5cbiAgY29tcGlsZU5leHRXb3JkVXJsIDogZnVuY3Rpb24oKSB7XG4gICAgLypcbiAgICAgIEV4YW1wbGU6IC9hcGkvd29yZHMvaW5kZXgvP2xhbmd1YWdlPWVuZ2xpc2gmZ2VuZGVyPW1hbGVcbiAgICAqL1xuICAgIHZhciBsYW5ndWFnZSA9ICdsYW5ndWFnZT0nICsgdGhpcy5zdGF0ZS5sYW5ndWFnZTtcbiAgICB2YXIgZ2VuZGVyID0gJ2dlbmRlcj0nICsgdGhpcy5zdGF0ZS5nZW5kZXI7XG4gICAgdmFyIHVybCA9ICcvYXBpL3dvcmRzL2luZGV4Lz8nICsgbGFuZ3VhZ2UgKyAnJicgKyBnZW5kZXI7XG4gICAgXG4gICAgcmV0dXJuIHVybDtcbiAgfSxcblxuICBwbGF5V29yZDogZnVuY3Rpb24oKSB7XG4gICAgd2luZG93LkF1ZGlvQ29udGV4dCA9IHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgd2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDtcbiAgICB2YXIgY29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICB2YXIgczNrZXkgPSB0aGlzLnN0YXRlLnMza2V5O1xuXG4gICAgZnVuY3Rpb24gbG9hZFNvdW5kKCkge1xuICAgICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgIHJlcXVlc3Qub3BlbihcIkdFVFwiLCBcImh0dHBzOi8vbG9jYWxob3N0OjMwMDAvYXBpL2F1ZGlvL1wiICsgczNrZXksIHRydWUpO1xuICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSBcImFycmF5YnVmZmVyXCI7XG5cbiAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBEYXRhID0gcmVxdWVzdC5yZXNwb25zZTtcbiAgICAgICAgcHJvY2VzcyhEYXRhKTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Quc2VuZCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByb2Nlc3MoRGF0YSkge1xuICAgICAgdmFyIHNvdXJjZSA9IGNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7IC8vIENyZWF0ZSBTb3VuZCBTb3VyY2VcbiAgICAgIGNvbnRleHQuZGVjb2RlQXVkaW9EYXRhKERhdGEsIGZ1bmN0aW9uKGJ1ZmZlcikge1xuICAgICAgICBzb3VyY2UuYnVmZmVyID0gYnVmZmVyO1xuICAgICAgICBzb3VyY2UuY29ubmVjdChjb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgc291cmNlLnN0YXJ0KGNvbnRleHQuY3VycmVudFRpbWUpO1xuICAgICAgICAvLyBDbG9zZSBhdWRpbyBjb250ZXh0IHdoZW4gZmlsZSBpcyBkb25lXG4gICAgICAgIHNvdXJjZS5vbmVuZGVkID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICBjb250ZXh0LmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGxvYWRTb3VuZCgpO1xuICB9LFxuXG4gIHJlcXVlc3RVc2VyQXVkaW9QZXJtaXNzaW9uOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWVkaWFDb25zdHJhaW50cyA9IHtcbiAgICAgIGF1ZGlvOiB0cnVlLFxuICAgICAgdmlkZW86IGZhbHNlXG4gICAgfTtcblxuICAgIHZhciBzdWNjZXNzQ2FsbGJhY2sgPSBmdW5jdGlvbiAobWVkaWFTdHJlYW0pIHtcbiAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgIHR5cGU6ICdhdWRpbycsXG4gICAgICAgIG51bWJlck9mQXVkaW9DaGFubmVsczogMVxuICAgICAgfTtcblxuICAgICAgdGhpcy5yZWNvcmRSVEMgPSBSZWNvcmRSVEMobWVkaWFTdHJlYW0sIGNvbmZpZyk7XG4gICAgfTtcblxuICAgIHZhciBlcnJvckNhbGxiYWNrID0gZnVuY3Rpb24oZXJyKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH07XG5cbiAgICAvLyBUT0RPOiBjaGVjayBmb3IgYnJvd3NlciBjb21wYXRhYmlsaXR5IHdpdGggbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoKVxuICAgIC8vIG5hdmlnYXRvci5nZXRVc2VyTWVkaWEgaXMgZGVwcmVjYXRlZCBhbmQgc2hvdWxkIGJlIGF2b2lkZWQgaWYgcG9zc2libGVcbiAgICBuYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKG1lZGlhQ29uc3RyYWludHMsIHN1Y2Nlc3NDYWxsYmFjay5iaW5kKHRoaXMpLCBlcnJvckNhbGxiYWNrKTtcbiAgfSxcblxuICBzdGFydFJlY29yZGluZ1VzZXJBdWRpbzogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5yZWNvcmRSVEMuc3RhcnRSZWNvcmRpbmcoKTtcbiAgfSxcblxuICBzdG9wUmVjb3JkaW5nVXNlckF1ZGlvOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnJlY29yZFJUQy5zdG9wUmVjb3JkaW5nKGZ1bmN0aW9uKGF1ZGlvVVJMKSB7XG4gICAgICB2YXIgc291bmRCbG9iID0gdGhpcy5yZWNvcmRSVEMuYmxvYjtcbiAgICAgIHRoaXMucG9zdEF1ZGlvRmlsZShzb3VuZEJsb2IpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH0sXG4gIHBvc3RBdWRpb0ZpbGU6IGZ1bmN0aW9uKHNvdW5kQmxvYikge1xuICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlckF1ZGlvJywgc291bmRCbG9iKTtcbiAgICAkLmFqYXgoe1xuICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgdXJsOiAnL2FwaS9hdWRpby8nLFxuICAgICAgZGF0YTogZm9ybURhdGEsXG4gICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXG4gICAgICBjb250ZW50VHlwZTogJ2F1ZGlvL3dhdicsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIHRoaXMucmVjb3JkUlRDLmNsZWFyUmVjb3JkZWREYXRhKCk7XG4gICAgICAgIHZhciBwZXJjZW50Q29ycmVjdCA9IE1hdGguZmxvb3IoZGF0YSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIHBlcmNlbnRDb3JyZWN0OiBwZXJjZW50Q29ycmVjdFxuICAgICAgICB9KTtcbiAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJy9hcGkvYXVkaW8nLCBzdGF0dXMsIGVyci50b1N0cmluZygpKTtcbiAgICAgIH0uYmluZCh0aGlzKVxuICAgIH0pO1xuICB9LFxuXG4gIHBvc3RUYXJnZXRXb3JkOiBmdW5jdGlvbigpIHtcbiAgICAkLmFqYXgoe1xuICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgdXJsOiAnL2FwaS93b3JkLycsXG4gICAgICBkYXRhOiB7J3dvcmQnOiB0aGlzLnN0YXRlLnRhcmdldFdvcmR9LFxuICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBhbGVydChkYXRhKTtcbiAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJy9hcGkvd29yZC8nLCBzdGF0dXMsIGVyci50b1N0cmluZygpKTtcbiAgICAgIH0uYmluZCh0aGlzKVxuICAgIH0pOyAgXG4gIH0sXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGFuZ3VhZ2U6ICdlbmdsaXNoJyxcbiAgICAgIGdlbmRlcjogJ21hbGUnLFxuICAgICAgdGFyZ2V0V29yZDogbnVsbCxcbiAgICAgIHBlcmNlbnRDb3JyZWN0OiBudWxsLFxuICAgIH07XG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMubG9hZFdvcmRGcm9tU2VydmVyKCk7XG4gICAgdGhpcy5yZXF1ZXN0VXNlckF1ZGlvUGVybWlzc2lvbigpO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdj5cbiAgICAgICAgPFRhcmdldFdvcmQgdGFyZ2V0V29yZD17dGhpcy5zdGF0ZS50YXJnZXRXb3JkfSAvPlxuICAgICAgICA8UGxheVdvcmRCdG4gcGxheVdvcmQ9e3RoaXMucGxheVdvcmR9IC8+XG4gICAgICAgIDxSZWNvcmRBdWRpb0J0biBcbiAgICAgICAgICBzdGFydFJlY29yZGluZz17dGhpcy5zdGFydFJlY29yZGluZ1VzZXJBdWRpb31cbiAgICAgICAgICBzdG9wUmVjb3JkaW5nPXt0aGlzLnN0b3BSZWNvcmRpbmdVc2VyQXVkaW99XG4gICAgICAgIC8+XG4gICAgICAgIDxQZXJjZW50Q29ycmVjdCBwZXJjZW50Q29ycmVjdD17dGhpcy5zdGF0ZS5wZXJjZW50Q29ycmVjdH0gLz5cbiAgICAgICAgPE5leHRXb3JkQnRuIG9uQ2xpY2s9e3RoaXMubG9hZFdvcmRGcm9tU2VydmVyfSAvPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgICB9XG4gIH0pO1xuXG52YXIgSW5zdHJ1Y3Rpb25zID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICByZW5kZXI6IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxoMz5cbiAgICAgICAgICBDbGljayBhbmQgaG9sZCB0aGUgbWljcm9waG9uZSBidXR0b24sIHdoaWxlIHByb25vdW5jaW5nIHRoZSB3b3JkIHNob3duIGJlbG93XG4gICAgICAgIDwvaDM+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59KTtcblxudmFyIFRpdGxlID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICByZW5kZXI6IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIDxoMSBjbGFzc05hbWU9XCJ0aXRsZVwiPlZvY2FsaXplPC9oMT5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgVm9jYWxpemVBcHAgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIHJlbmRlcjogZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdj5cbiAgICAgICAgPFRpdGxlIC8+XG4gICAgICAgIDxJbnN0cnVjdGlvbnMgLz5cbiAgICAgICAgPFByb251bmNpYXRpb25UZXN0IC8+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59KTtcblxuUmVhY3RET00ucmVuZGVyKFxuICA8Vm9jYWxpemVBcHAvPiwgXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2b2NhbGl6ZUFwcCcpXG4pOyJdfQ==
